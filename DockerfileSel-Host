FROM ubuntu
MAINTAINER Sam Irvine

USER root
RUN apt-get update -y && apt-get install -y default-jdk unzip ruby ruby-dev make gcc

ADD https://goo.gl/Lyo36k /opt/selenium-server-standalone-3.0.1.jar
RUN mkdir /opt/sel-java
ADD http://selenium-release.storage.googleapis.com/3.0/selenium-java-3.0.1.zip /opt/sel-java
RUN unzip /opt/sel-java/selenium-java-3.0.1.zip -d /opt/sel-java
#RUN mkdir /opt/sel-ruby
#ADD http://rubygems.org/gems/selenium-webdriver /opt/sel-ruby
RUN gem update --system
RUN gem install rspec
RUN gem install selenium-webdriver

#ENV JAVA_HOME /usr/lib/jvm/default-java
ENV PATH ${PATH}:/usr/lib/jvm/default-java:/opt/geckodriver/geckodriver
RUN mkdir /opt/geckodriver
ADD https://github.com/mozilla/geckodriver/releases/download/v0.11.1/geckodriver-v0.11.1-linux64.tar.gz /opt/geckodriver
RUN tar xzvf /opt/geckodriver/geckodriver-v0.11.1-linux64.tar.gz -C /opt/geckodriver

#RUN java -jar /opt/selenium-server-standalone-3.0.1.jar -role hub
#RUN java -jar /opt/selenium-server-standalone-3.0.1.jar -role node  -hub http://localhost:4444/grid/register

#RUN java -jar /opt/selenium-server-standalone-3.0.1.jar -role hub & && gem install selenium-webdriver


ENTRYPOINT java -jar /opt/selenium-server-standalone-3.0.1.jar -role hub
